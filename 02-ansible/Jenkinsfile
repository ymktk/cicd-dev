def ANSIBLE_CONFIG = """\
[defaults]
log_path = ./ansible.log
"""

pipeline {

  // agent any

  agent {
    docker {
      image 'ymktk/ansible:ansible-2.9.5-centos'
      args '-v $HOME/.m2:/root/.m2'
    }
  }

  stages() {

    stage('1. Greeting') {
      steps {
        echo 'Hello world'
      }
    }

    // stage('2. Get ansible files') {
    //   steps {
    //     deleteDir()
    //     git 'git@github.com:ymktk/jenkins.git'
    //     writeFile(file: "ansible.cfg", text: "${ANSIBLE_CONFIG}")
    //   }
    // }

    stage('3. Executions') {
      steps() {
        sh 'hostname'
        sh 'pwd'
        sh 'id'
        sh 'ls -l'
      }
    }

  } // End Stages

  post {
    success {
      cleanWs()
    }
  }

}
